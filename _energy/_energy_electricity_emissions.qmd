## Electricity

```{r  include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.pos = "H",
  out.width = "100%",
  dpi = 300
)


knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
```

```{r, include=FALSE}
source(file.path(here::here(), "R/_quarto_helpers.R"))
source(file.path(here::here(), "R/_load_pkgs.R"))
hookaddcap()
```

### Introduction

Emissions from the electricity generation sector have declined by 54% in Minnesota since 2005, largely as a result of transitions in the grid towards energy sources such as wind and solar [@mpcaClimateChangeTrends2023]. In 2023, MN Governor Walz signed a bill mandating a statewide carbon-free electricity standard by 2040. The law "establishes a standard for utilities to supply Minnesota customers with electricity generated or procured from carbon-free resources, beginning at an amount equal to 80% of retail sales for public utility customers in Minnesota in 2030 and increasing every 5 years to reach 100% for all electric utilities by 2040. The bill also requires that, by 2035, an amount equal to at least 55% of an electric utility’s total retail electric sales to customers in Minnesota must be generated or procured from eligible energy technologies." Wisconsin has not adopted a similar carbon-free electricity standard, but a Wisconsin DNR report noted both the economic gains from such to the renewable energy economy in the state, as well as the opportunities for decarbonization [@holt2019].

### Methods

The general workflow for quantifying electricity emissions is to identify all of the electric utilities that operate within our study area, collect/aggregate reporting they provide to the states of Minnesota and Wisconsin about the amount of energy delivered to all their customers (with reference to federal reporting sources where state-level reporting gaps exist), and apply EPA-provided emissions factors to the reported activity/energy deliveries to calculate estimated emissions. Methodologies for allocating utility activity reports to counties varies across MN and WI and are further described in the following section. Most inputs we use in the construction of our electricity emissions data set are of the highest quality rank, as they are either direct government-created data (e.g., emissions factors) or reported to state/federal authorities (e.g., regulatory filings). However, for two Minnesota electric utilities – Elk River Municipal Utilities [@elkrivermunicipalutilities2021AnnualFinancial2022] and New Prague Utilities Commission [@newpragueutilitiescommissionAgendaPacket242022] – where regulatory filing data could not be sourced to quantify electricity deliveries, we referred to financial reporting documents published by the utilities.

Total regional emissions (Emissions~r~) represents the sum of all recorded energy deliveries by utility *i* within county *j*, where *i* refers to each of the electric utilities operating across our region, and *j* refers to the eleven counties included in this inventory. Our regional total therefore represents an aggregation of electricity deliveries for all distinct utility-county records (i.e., a row for every utility's operation within each county they operate in) within our 11 counties.

$$Emissions_r = \Sigma_j (mwhDelivered_iCounty_j \times {Emissions Factor}) $$

Our inventory takes a "demand-side" approach to emissions quantification and seeks to aggregate all confirmed/reported delivery of energy to ALL customers served by utilities (meaning all customer types, inclusive of residential, commercial, industrial, and government accounts). This means that energy loss/use experienced by utilities in the process of energy generation, transmission, and delivery and resale to utilities operating outside of our study area are not directly reflected in the numbers attributed to counties. The U.S. Energy Information Administration (EIA) estimates that annual electricity transmission and distribution (T&D) losses averaged about 5% of the electricity transmitted and distributed in the United States in 2018 through 2022. [@u.s.energyinformationadministrationHowMuchElectricity2023]

#### Identifying utilities in scope

To identify the electric utilities that operate within our 11-county study area, we referred to maps/geospatial datasets capturing utility service areas in Minnesota and Wisconsin. To identify Wisconsin electric utilities, we downloaded the Electric Service Territory map maintained by the Wisconsin Public Service Commission [@wisconsinpublicservicecommissionElectricServiceTerritories2024]. To identify Minnesota electric utilities, we downloaded the Electric Service Territory map maintained by the Minnesota Public Utilities Commission and the Minnesota IT Geospatial Information Office[@minnesotaitgeospatialinformationofficeElectricUtilityService2023].

#### Collecting and aggregating activity data from utilities

After identifying which utilities operate within our study area within each state, we collect reporting submitted by these utilities to the relevant state and federal authorities and use a variety of approaches, depending on data availability, to allocate utility activity/energy deliveries to specific counties.

##### Minnesota

All electric utilities authorized to do business in Minnesota are required to file an annual data report pursuant to MN Rules Chapter 7610. The Minnesota Public Utilities Commission makes these reports searchable through an [eFiling Site](https://www.edockets.state.mn.us/EFiling/edockets/searchDocuments.do?method=eDocketsResult&docketYear=22&docketNumber=19) , and downloadable as Excel workbooks [@minnesotadepartmentofcommerceCHAPTER7610ENERGY]. For each utility identified in distinct_electricity_util_type_MN.RDS (a data product of minnesota_electricUtilities.R, a script that looks for intersections between electric utility service areas and our Minnesota counties), we downloaded the relevant 2021 annual reports from this site (see note about Great River Energy in the previous section for caveats), except for North Branch Municipal Water and Light, which did not submit a 2021 report (we used their 2022 report as a substitution). Elk River Municipal Utilities and New Prague Utilities Commission did not file reports for 2021 or 2022, and so we used financial reports to identify their total electricity delivered; both utilities operated within only one county in our study area, which meant no estimation/allocation was necessary.

We wrote code to extract the county-level data reported in report section "ITS DELIVERIES TO ULTIMATE CONSUMERS BY COUNTY FOR THE LAST CALENDAR YEAR" on the relevant annual data report Excel workbooks compiled into a folder directory, and created a table with three columns: county, utility, and mWh_delivered (megawatt-hours). By compiling this data for all utilities found to operate within our study area, aggregating utility activity data (and thus, enabling the quantification of estimated emissions, after the application of an emissions factor) at the county level becomes possible.

##### Wisconsin

All municipal and investor-owned utilities authorized to do business in Wisconsin are required to file an annual report with financial and operational information pursuant to Wis. Stat. § 196.07. The Public Services Commission of Wisconsin makes these reports searchable through an [E-Services Portal](https://apps.psc.wi.gov/ARS/annualReports/default.aspx), and downloadable as either PDFs or Excel workbooks, with options to export only specific portions of the reports as spreadsheets [@publicservicecommissionofwisconsin2022]. For each utility identified in distinct_electricity_util_type_WI.RDS (a data product of wisconsin_electricUtilities.R, a script that looks for intersections between electric utility service areas and our Wisconsin counties), we downloaded the relevant 2021 annual reports from this site.

A similar process was followed for the four Wisconsin cooperative utilities for which we referenced federal regulatory filings data to populate our dataset of electricity deliveries.

Because of the small amount of data, and the different data structures of the reports for municipally-, cooperatively-, and investor-owned utilities in Wisconsin, we hard-coded observed information into data frames rather than extracting data through a web scraper or document analyzer (see *processed_wi_electricUtil_activityData.R* on the GitHub repository).

#### Emissions factors

To transform electricity deliveries (recorded in mWh) into emissions in metric tons CO~2~e, we referenced 2021 Emissions & Generation Resource Integrated Database (eGRID) summary data for the MROW subregion (Midwest Reliability Organization - West). [@usepaEGRIDEmissionsGeneration2021]

MROW map?

This dataset provides estimates in lbs/mWh for CO~2~, CH4, N~2~O, and CO~2~e emissions based on MROW's sub-regional electricity generation grid mix; applying this factor to the county-level estimates for mWh and dividing by 2000 yields an estimate for CO~2~e in metric tons. To generate this sub-regional estimate, eGRID first calculates estimated emissions at the plant level, and assigns plants to regions. From this infoirmation, Our inventory thus accounts for the specific grid mix in our study area by referencing the localized estimate generated by eGRID, shown below. Per the eGRID technical guide, "the subregions were defined to limit the import and export of electricity in order to establish an aggregated area where the determined emission rates most accurately matched the generation and emissions from the plants within that subregion."

#GRID MIX

### Results

```{r fig-electricity-county-emissions}
#| fig-cap: "2021 electricity emissions by county"
#| out-width: "95%"
mn_emissions <- read_rds(file.path(here::here(), "_energy/data/minnesota_county_ElecEmissions.RDS"))
wi_emissions <- read_rds(file.path(here::here(), "_energy/data/wisconsin_county_ElecEmissions.RDS")) %>%
  rename(county = county_name)

elecEmissions_all <- rbind(mn_emissions, wi_emissions) %>%
  mutate(geo = paste0(county, ", ", state))

plot_ly(
  type = "bar",
  source = opts_current$get()$label,
  data = elecEmissions_all,
  y = ~ reorder(geo, emissions_metric_tons_co2e),
  x = ~emissions_metric_tons_co2e,
  hovertemplate = ~ paste0(
    geo, "<br>",
    "Emissions: %{x:,.2f} metric tons CO<sub>2</sub>e", "<br>",
    "<extra></extra>"
  )
) %>%
  plotly_layout(
    main_title = "2021 county-level CO2e electricity emissions",
    subtitle = "",
    yaxis = list(
      ticklen = 5,
      tickwidth = 2,
      tickcolor = "#000",
      tickfont = list(size = 14)
    ),
    xaxis = list(
      title = "Greenhouse gases emitted (metric tons)"
      # ... [any other x-axis settings] ...
    ),
    margin = list(l = 120)
  ) %>%
  layout(
    barmode = "stack",
    legend = list(
      traceorder = "reversed"
    )
  )
```

#### Correlation with related data

We would expect counties with higher population to have higher emissions.

```{r fig-emissions-population}
#| fig-cap: "County population and electricity emissions"
#| out-width: "95%"
cprg_population <- readRDS(file.path(here::here(), "_meta/data/cprg_population.RDS"))
emissions_population <- left_join(elecEmissions_all, cprg_population,
  by = c("county" = "NAME")
)
plot_ly(
  data = emissions_population,
  source = opts_current$get()$label,
  x = ~population,
  y = ~emissions_metric_tons_co2e,
  type = "scatter",
  mode = "markers",
  hovertemplate = ~ paste0(
    county, " County", "<br>",
    "Population: ", scales::comma(population), "<br>",
    "Emissions: %{y:,.2f} metric tons CO<sub>2</sub>e", "<br>",
    "<extra></extra>"
  ),
  opacity = 0.7,
  marker = list(
    size = 18,
    line = list(
      color = "lightgray",
      width = 2
    )
  )
) %>%
  plotly_layout(
    main_title = "County population and emissions",
    subtitle = "2021 ACS 5-year population estimates",
    x_title = "Total population",
    y_title = "Emissions"
  )
```

#### Comparison with other inventories

-   2018 Met Council inventory

```{r echo=FALSE}
caption_index <- readRDS(file.path(here::here(), "caption_index.RDS"))
caption_index <- as.character(as.numeric(caption_index) + 1) %>% stringr::str_pad(width = 2, side = "left", pad = "0")
saveCap(paste0("cap-", caption_index))
saveRDS(caption_index, file.path(here::here(), "caption_index.RDS"))
```

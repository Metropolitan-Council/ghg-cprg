## MPCA SCORE {#sec-mpca-score}

```{r}
source(file.path(here::here(), "R/_quarto_helpers.R"))
source(file.path(here::here(), "R/_load_pkgs.R"))
source(file.path(here::here(), "R/_plotting_helpers.R"))
# pull data here
mpca_score <- readRDS(file.path(here::here(), "_waste/data/mpca_score.RDS")) %>%
  mutate(Method = ifelse(Method == "WTE", "Waste-to-Energy", Method)) %>%
  mutate(Method = factor(Method,
    levels = c(
      "Waste-to-Energy",
      "Organics",
      "Recycling",
      "Landfill",
      "MSW Compost",
      "Onsite"
    ),
    ordered = TRUE
  ))
mpca_score_meta <- readRDS(file.path(here::here(), "_waste/data/mpca_score_meta.RDS"))
cprg_county <- readRDS(file.path(here::here(), "_meta/data/cprg_county.RDS"))
cprg_pop <- readRDS(file.path(here::here(), "_meta/data/cprg_population.RDS"))
epa_ghg_factor_hub <- readRDS(file.path(here::here(), "_meta/data/epa_ghg_factor_hub.RDS"))
source(file.path(here::here(), "_meta/data-raw/epa_nei.R"))
hookaddcap()
```


The Minnesota Pollution Control Agency collects an annual inventory, [SCORE](https://public.tableau.com/app/profile/mpca.data.services/viz/SCOREOverview/1991-2021SCORE), of solid waste, recycling and organics as reported by counties across the state. For this project, we used MPCA data for the nine Minnesota counties for the year 2021. SCORE is named for the Governor's Select Committee on Recycling and the Environment, which first proposed funding laws in 1989 [@mpcaUnderstandingSolidWaste2023]. 

The SCORE data is a high-quality government dataset submitted annually by solid waste staff in each county of Minnesota, as a part of Minnesota's SCORE laws to support waste reduction and calculate the cost of managing waste and recycling. The data provided includes the total short tons of waste generated in each county within each "Method" category, described below.

The data was accessed through the SCORE tool's Tableau dashboard, then filtered to include only the 9-county Minnesota portion of the region studied in this report.

#### Data distribution

To check if the data is reasonable, we can start by visualizing the tons of waste generated for each county, broken into categories. 

We would expect waste from landfills to be greater than recycling in most cases, and both landfill and recycling waste to be greater than compost (or "organics").  We can see that this expectation largely holds true, with the exception of Ramsey County, where compost outstrips both recycling and landfill. Part of the explanation for this may lie in the fact that, like Hennepin and Washington, a large portion of Ramsey County's waste is managed in Waste-to-Energy facilities rather than landfills. This is consistent with waste management strategies of the metropolitan areas within Ramsey, Hennepin and Washington counties [@alexanderHennepinCountyGreenhouse2020].

We also note that only two counties, Chisago and Sherburne, processed waste through onsite waste processors in 2021.  

```{r fig-total-waste}
#| fig-cap: "Total waste generated by county"
#| out-width: "95%"

# is this too many categories. should i switch to side-by-side bar plot
mpca_score_no_msw <- mpca_score %>%
  filter(!Method == "MSW Compost")

fig_total_waste <- plot_ly(
  data = mpca_score_no_msw,
  x = ~ reorder(County, -Tons),
  y = ~Tons,
  source = "fig-total-waste",
  type = "bar",
  hoverinfo = "text",
  color = ~Method,
  colors = unlist(management_method_colors),
  hovertemplate = ~ paste0(
    "County: ", County, "<br>",
    "Management method: ", Method, "<br>",
    "Waste generated: ", round(Tons / 1000), " thousand tons",
    "<extra></extra>"
  )
) %>%
  plotly_layout(
    main_title = "Total waste generated per county",
    subtitle = "Minnesota Pollution Control Agency (MPCA) SCORE",
    x_title = "County",
    y_title = "Waste (tons)",
    legend_title = "Management method",
    barmode = "stack"
  ) %>%
  layout(
    barmode = "stack"
  )
fig_total_waste
```

We would expect that the total amount of waste generated would be generally positively correlated with county area. 

We see that this correlation holds loosely. The one major outlier is Ramsey County, which inculdes the St. Paul metropolitan area.

```{r fig-waste-county-area}
#| fig-cap: "Total waste generated by county and county area"
#| out-width: "95%"

# Ignored exploration of area vs. total waste - little correlation, compare to area vs. pop
cprg_area_mn <- cprg_county %>%
  mutate(area_sq_mi = sf::st_area(cprg_county) %>% units::set_units("mi^2") %>%
    as.numeric()) %>%
  filter(STATE == "Minnesota")

mpca_score_area_summary <- mpca_score %>%
  filter(!Method == "MSW Compost") %>%
  group_by(County) %>%
  mutate(Total = sum(Tons)) %>%
  full_join(cprg_area_mn, by = join_by(County == NAME))

fig_waste_county_area <- plot_ly(
  data = mpca_score_area_summary,
  x = ~area_sq_mi,
  y = ~Total,
  source = "fig-waste-county-area",
  type = "scatter",
  mode = "markers",
  hoverinfo = "text",
  hovertemplate = ~ paste0(
    "County: ", County, "<br>",
    "Waste generated: ", round(Total / 1000), " thousand tons", "<br>",
    "Area: ", round(area_sq_mi), " sq mi",
    "<extra></extra>"
  ),
  marker = list(
    color = colors$councilBlue,
    size = 18,
    line = list(
      color = "lightgray",
      width = 2
    )
  )
) %>%
  plotly_layout(
    main_title = "Total waste by county area",
    subtitle = "Minnesota Pollution Control Agency (MPCA) SCORE",
    x_title = "Area (sq. mi.)",
    y_title = "Waste (tons)"
  )

fig_waste_county_area
```

We would expect that counties with large populations, such as Ramsey County, would generate more waste and smaller counties would generate less.

Comparing waste generated and population, we see a strong positive correlation (the more people there are within the county, the more waste they generate).

```{r fig-waste-county-pop}
#| fig-cap: "Total waste generated by county and county population"
#| out-width: "95%"
cprg_pop_mn <- cprg_pop %>%
  filter(STATE == "Minnesota")

mpca_score_population <- mpca_score %>%
  filter(!Method == "MSW Compost") %>%
  group_by(County) %>%
  mutate(Total = sum(Tons)) %>%
  full_join(cprg_pop_mn, by = join_by(County == NAME))

fig_waste_county_pop <- plot_ly(
  data = mpca_score_population,
  x = ~population,
  y = ~Total,
  source = "fig-waste-county-pop",
  type = "scatter",
  mode = "markers",
  hoverinfo = "text",
  hovertemplate = ~ paste0(
    "County: ", County, "<br>",
    "Waste generated: ", round(Total / 1000), " thousand tons", "<br>",
    "Population: ", round(population),
    "<extra></extra>"
  ),
  marker = list(
    size = 18,
    color = colors$councilBlue,
    line = list(
      color = "lightgray",
      width = 2
    )
  )
) %>%
  plotly_layout(
    main_title = "Total waste by county population",
    subtitle = "Minnesota Pollution Control Agency (MPCA) SCORE",
    x_title = "Population",
    y_title = "Waste (tons)"
  )
fig_waste_county_pop
```

### Data characteristics

This data includes MSW Compost as a category, but since all values for this category in the area and year needed were 0, we excluded it from our analysis.

Uncertainty was not included in the dataset given, nor does the EPA offer guidance for estimating uncertainty of solid waste emissions factors.

<!-- - Plots, tables, and description of data distribution -->
<!-- - Variance, Z-Score, quantiles -->
<!-- - Facet views by categorical variables -->

### Waste management classification

The MPCA SCORE report classifies waste management by two management methods and, within those categories, five sub-methods [@mpcaSustainableMaterialsManagement2023]. Within the management methods, "MMSW", or "Mixed Municipal Solid Waste", refers to garbage, organic refuse, or other solid waste aggregated for collection, while "Combined Recycling and Organics" refers to separated recyclable and composted materials, including traditional recyclables, source-separated compostable materials, and yard trimmings.

MMSW includes the subcategories of Landfill, WTE, Onsite, and MSW Compost. Landfill is all material disposed of in a landfill. WTE, or Waste to Energy, refers to waste combusted in an energy recovery facility or incinerator. Onsite refers to burning or burying MSW [@mpcaSustainableMaterialsManagement2023]. MSW Compost includes [all compost separated from landfill, check]. No metropolitan counties reported any MSW Compost in the year 2021. Only Sherburne and Chisago counties reported waste managed on-site. 

Combined Recycling and Organics includes the subcategories Recycling and Organics. Organics, as compared to MSW Compost, refers to source-separated and direct compost streams. All compost data in this report comes from this category.

After comparing with federal tools like the EPA's [Waste and Recycling National Overview](https://www.epa.gov/facts-and-figures-about-materials-waste-and-recycling/national-overview-facts-and-figures-materials) and the expectations of a greenhouse gas inventory, we chose to summarise SCORE's data into three categories: Landfill, Recycling, and Organics. Landfill includes, in addition to MPCA-reported Landfill data, the categories of Onsite and WTE management.

#### Alignment with EPA Emissions Factors

We used emissions factors from the EPA's [Emission Factors Hub](https://www.epa.gov/climateleadership/ghg-emission-factors-hub) to calculate emissions based on the totals reported by the MPCA. These emissions factors come from the EPA's [Waste Reduction Model](https://www.epa.gov/warm). 

We selected for each management subcategory the emissions factor most aligned with the waste type as reported in SCORE. These emissions factors do not take into account emissions savings associated with a particular management method, for example energy savings from waste to energy facilities.

```{r tbl-solid-waste-management-classifications}
#| tbl-cap: "Solid waste management classifications by data source, including emissions factors"
#| out-width: "95%"

# waste_factors <- epa_ghg_factor_hub$waste
# TODO fix table here with actual epa_ghg_factor_hub values used

waste_management_comp <-
  tribble(
    ~`MPCA Management Method`, ~`MPCA Method`, ~`Our Category`, ~`Emissions Factor Name`, ~`Emissions Factor`,
    "MMSW", "Landfill", "Landfill", "Mixed MSW Landfilled", "0.52",
    "MMSW", "Onsite", "Landfill", "Mixed MSW Landfilled", "0.52",
    "MMSW", "WTE", "Waste to Energy", "Mixed MSW Combusted", "0.43",
    "MMSW", "MSW Compost", "Organics", "N/A", "N/A",
    "Combined Recycling and Organics", "Organics", "Organics", "Mixed Organics Composted", "0.17",
    "Combined Recycling and Organics", "Recycling", "Recycling", "Mixed Recyclables Recycled", "0.09"
  )

gt::gt(waste_management_comp,
  row_group_as_column = FALSE
) %>%
  tab_style(
    style = list(
      cell_fill(
        color = "lightgray",
        alpha = 0.5
      ),
      cell_borders(sides = "top")
    ),
    locations = cells_body(
      columns = 1:3,
      rows = 1:3
    )
  ) %>%
  tab_style(
    style = list(
      cell_fill(
        color = "lightgray",
        alpha = 0.5
      ),
      cell_borders(sides = "top")
    ),
    locations = cells_body(
      columns = 1,
      rows = 4
    )
  ) %>%
  tab_style(
    style = list(
      cell_fill(
        color = "lightblue",
        alpha = 0.5
      ),
      cell_borders(sides = "top")
    ),
    locations = cells_body(
      columns = 1:3,
      rows = 6
    )
  ) %>%
  tab_style(
    style = list(
      cell_fill(
        color = "lightblue",
        alpha = 0.5
      ),
      cell_borders(sides = "top")
    ),
    locations = cells_body(
      columns = 1,
      rows = 5
    )
  ) %>%
  tab_style(
    style = list(
      cell_fill(
        color = "lightgreen",
        alpha = 0.5
      ),
      cell_borders(sides = "top")
    ),
    locations = cells_body(
      columns = 2:3,
      rows = 4:5
    )
  ) %>%
  tab_style(
    style = list(
      cell_fill(
        color = "lightpink",
        alpha = 0.5
      ),
      cell_borders(sides = "top")
    ),
    locations = cells_body(
      columns = 2:3,
      rows = 3
    )
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  fmt_markdown() %>%
  as_raw_html()
```


### Limitations

- As mentioned above, EPA emissions factors do not account for emissions saved through Waste to Energy conversions, as contrasted with Wisconsin emissions, which do.
- There is wide variation between emissions factors for waste of various kinds within the same category. Because we do not have a detailed breakdown of the makeup of every category, we have assumed each one is adequately represented by the "Mixed MSW", "Mixed Organics", and "Mixed Recyclables" factors respectively.
- This estimation method generates emissions for all waste generated in 2021. However, waste in landfills and composting facilities does not release all emissions at once. This method tends to overestimate emissions for a given year [@fongGlobalProtocolCommunityScale2021].

Subject matter expert reviewer: ___


<!-- ### Data Dictionary -->
<!-- Table with detailed description of columns and definitions for each data table. -->


```{r echo=FALSE, eval=FALSE}
caption_index <- readRDS(file.path(here::here(), "caption_index.RDS"))
caption_index <- as.character(as.numeric(caption_index) + 1) %>% stringr::str_pad(width = 2, side = "left", pad = "0")
saveCap(paste0("cap-", caption_index))
saveRDS(caption_index, file.path(here::here(), "caption_index.RDS"))
```
{{< pagebreak >}}

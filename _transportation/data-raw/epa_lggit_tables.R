# other transportation-related LGGIT tables -----
# metcouncil_community_ghg_inventorytool_11.28.23
# sourced from the "Factors" tab

# co2 by fuel type ----
lggit_co2 <- tibble::tribble(
  ~`Fuel Type`, ~Total, ~`Biogenic Portion`, ~`Fossil portion`, ~`MMBTU/unit`,
  "Gasoline",   8.78,                NA,            8.78,          0.13,
  "Diesel",  10.21,                NA,           10.21,          0.14,
  "Biodiesel (B5)",  10.17,              0.47,             9.7,          0.14,
  "Biodiesel (B20)",  10.06,              1.89,            8.17,          0.14,
  "B100",   9.45,              9.45,              NA,          0.13,
  "Ethanol (E85)",    6.2,              4.89,            1.32,          0.09,
  "E100",   5.75,              5.75,              NA,          0.08,
  "CNG",   6.84,                NA,            6.84,          0.13,
  "LNG",   4.46,                NA,            4.46,          0.08,
  "LPG",   5.79,                NA,            5.79,          0.09,
  "Methanol",    4.1,                NA,             4.1,            NA,
  "Residual Fuel",   11.8,                NA,            11.8,          0.15,
  "Jet Fuel",   9.57,                NA,            9.57,          0.14,
  "Aviation Gasoline",   8.31,                NA,            8.31,          0.12
)


# grams of other GHGs by vehicle year, vehicle type, and fuel source -----
# Source: Emissions Factors for Greenhouse Gas Inventories, U.S EPA April 2023. 
# Note that values are held constant by EPA for certain time series/vehicle types.
# See https://www.epa.gov/system/files/documents/2023-03/ghg_emission_factors_hub.pdf

year_column <- tibble::tribble(
  ~year,
  1980L,
  1981L,
  1982L,
  1983L,
  1984L,
  1985L,
  1986L,
  1987L,
  1988L,
  1989L,
  1990L,
  1991L,
  1992L,
  1993L,
  1994L,
  1995L,
  1996L,
  1997L,
  1998L,
  1999L,
  2000L,
  2001L,
  2002L,
  2003L,
  2004L,
  2005L,
  2006L,
  2007L,
  2008L,
  2009L,
  2010L,
  2011L,
  2012L,
  2013L,
  2014L,
  2015L,
  2016L,
  2017L,
  2018L,
  2019L,
  2020L
)

ch4_by_veh_year <- cbind(year_column, tibble::tribble(
  ~`Passenger Car | Gasoline`, ~`Light Truck (Vans, Pickup Trucks, SUVs) | Gasoline`, ~`Heavy-Duty Vehicle | Gasoline`,~`Passenger Car | Diesel`, ~`Light Truck (Vans, Pickup Trucks, SUVs) | Diesel`, ~`Heavy-Duty Vehicle | Diesel`,
  0.1696,                                     0.1594,                0.4604,         0.0006,                                     0.0011,                0.0051,
  0.1423,                                     0.1634,                0.4492,         0.0006,                                     0.0011,                0.0051,
  0.1406,                                     0.1594,                0.4492,         0.0006,                                     0.0011,                0.0051,
  0.1389,                                     0.1614,                0.4492,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.1594,                0.4492,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.1479,                0.4492,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.1442,                0.4492,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3675,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3492,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3492,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3246,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3246,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3246,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3246,         0.0005,                                     0.0009,                0.0051,
  0.0802,                                     0.1294,                0.3246,         0.0005,                                     0.0009,                0.0051,
  0.0795,                                      0.122,                0.3246,         0.0005,                                     0.0009,                0.0051,
  0.0782,                                     0.1146,                 0.409,         0.0005,                                     0.0009,                0.0051,
  0.0704,                                     0.0813,                0.3675,         0.0005,                                     0.0009,                0.0051,
  0.0617,                                     0.0646,                0.3492,         0.0005,                                     0.0009,                0.0051,
  0.0531,                                     0.0517,                0.3246,         0.0005,                                     0.0009,                0.0051,
  0.0434,                                     0.0452,                0.1278,         0.0005,                                     0.0009,                0.0051,
  0.0337,                                     0.0452,                0.0924,         0.0005,                                     0.0009,                0.0051,
  0.024,                                     0.0412,                0.0655,         0.0005,                                     0.0009,                0.0051,
  0.0215,                                     0.0333,                0.0648,         0.0005,                                     0.0009,                0.0051,
  0.0175,                                      0.034,                 0.063,         0.0005,                                     0.0009,                0.0051,
  0.0105,                                     0.0221,                0.0577,         0.0005,                                     0.0009,                0.0051,
  0.0102,                                     0.0242,                0.0634,         0.0005,                                     0.0009,                0.0051,
  0.0095,                                     0.0221,                0.0602,         0.0302,                                     0.0009,                0.0095,
  0.0078,                                     0.0115,                0.0298,         0.0302,                                      0.029,                0.0095,
  0.0075,                                     0.0105,                0.0297,         0.0302,                                      0.029,                0.0095,
  0.0076,                                     0.0108,                0.0299,         0.0302,                                      0.029,                0.0095,
  0.0072,                                     0.0103,                0.0322,         0.0302,                                      0.029,                0.0095,
  0.0072,                                     0.0095,                 0.034,         0.0302,                                      0.029,                0.0095,
  0.0071,                                     0.0095,                0.0339,         0.0302,                                      0.029,                0.0095,
  0.0071,                                     0.0095,                 0.032,         0.0302,                                      0.029,                0.0095,
  0.0071,                                     0.0096,                0.0304,         0.0302,                                      0.029,                0.0095,
  0.0071,                                     0.0096,                0.0313,         0.0302,                                      0.029,                0.0095,
  0.0071,                                     0.0095,                0.0313,         0.0302,                                      0.029,                0.0095,
  0.0071,                                     0.0095,                0.0315,         0.0302,                                      0.029,                0.0095,
  0.0068,                                     0.0094,                0.0332,         0.0302,                                      0.029,                0.0095,
  0.0065,                                     0.0091,                0.0321,         0.0302,                                      0.029,                0.0095
)) %>% 
  pivot_longer(cols = 2:7,
               values_to = "ch4_grams_per_mile") %>% 
  tidyr::separate_wider_delim(name, delim = "|",
                              names = c("Vehicle Type",
                                        "Fuel Type")) %>% 
  mutate(`Vehicle Type` = stringr::str_trim(`Vehicle Type`, "both"),
         `Fuel Type` = stringr::str_trim(`Fuel Type`, "both"))



n2o_veh_year <- cbind(year_column, tibble::tribble(
                               ~`Passenger Car | Gasoline`, ~`Light Truck (Vans, Pickup Trucks, SUVs) | Gasoline`, ~`Heavy-Duty Vehicle | Gasoline`, ~`Passenger Car | Diesel`, ~`Light Truck (Vans, Pickup Trucks, SUVs) | Diesel`, ~`Heavy-Duty Vehicle | Diesel`,
                                       0.0197,                                     0.0555,                0.0497,         0.0012,                                     0.0017,                0.0048,
                                       0.0443,                                     0.0513,                0.0538,         0.0012,                                     0.0017,                0.0048,
                                       0.0458,                                     0.0555,                0.0538,         0.0012,                                     0.0017,                0.0048,
                                       0.0473,                                     0.0534,                0.0538,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.0555,                0.0538,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                      0.066,                0.0538,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.0681,                0.0538,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.0849,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.0933,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.0933,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.1142,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.1142,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.1142,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.1142,          0.001,                                     0.0014,                0.0048,
                                       0.0626,                                     0.0764,                0.1142,          0.001,                                     0.0014,                0.0048,
                                       0.0627,                                     0.0806,                0.1142,          0.001,                                     0.0014,                0.0048,
                                        0.063,                                     0.0848,                0.0515,          0.001,                                     0.0014,                0.0048,
                                       0.0647,                                     0.1035,                0.0849,          0.001,                                     0.0014,                0.0048,
                                       0.0603,                                     0.0982,                0.0933,          0.001,                                     0.0014,                0.0048,
                                        0.056,                                     0.0908,                0.1142,          0.001,                                     0.0014,                0.0048,
                                       0.0503,                                     0.0871,                 0.168,          0.001,                                     0.0014,                0.0048,
                                       0.0446,                                     0.0871,                0.1726,          0.001,                                     0.0014,                0.0048,
                                       0.0389,                                     0.0787,                 0.175,          0.001,                                     0.0014,                0.0048,
                                       0.0355,                                     0.0618,                0.1724,          0.001,                                     0.0014,                0.0048,
                                       0.0304,                                     0.0631,                 0.166,          0.001,                                     0.0014,                0.0048,
                                       0.0212,                                     0.0379,                0.1468,          0.001,                                     0.0014,                0.0048,
                                       0.0207,                                     0.0424,                0.1673,          0.001,                                     0.0014,                0.0048,
                                       0.0181,                                     0.0373,                0.1553,         0.0192,                                     0.0014,                0.0431,
                                       0.0085,                                     0.0088,                0.0164,         0.0192,                                     0.0214,                0.0431,
                                       0.0067,                                     0.0064,                0.0083,         0.0192,                                     0.0214,                0.0431,
                                       0.0075,                                      0.008,                0.0241,         0.0192,                                     0.0214,                0.0431,
                                       0.0052,                                     0.0061,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0049,                                     0.0036,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0046,                                     0.0036,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0046,                                     0.0035,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0046,                                     0.0034,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0046,                                     0.0033,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0046,                                     0.0035,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0046,                                     0.0033,                0.0015,         0.0192,                                     0.0214,                0.0431,
                                       0.0042,                                     0.0031,                0.0021,         0.0192,                                     0.0214,                0.0431,
                                       0.0038,                                     0.0029,                0.0061,         0.0192,                                     0.0214,                0.0431
                               )) %>% 
  pivot_longer(cols = 2:7,
               values_to = "n2o_grams_per_mile") %>% 
  tidyr::separate_wider_delim(name, delim = "|",
                              names = c("Vehicle Type",
                                        "Fuel Type")) %>% 
  mutate(`Vehicle Type` = stringr::str_trim(`Vehicle Type`, "both"),
         `Fuel Typpe` = stringr::str_trim(`Fuel Type`, "both"))


lggit_ch4_n2o_veh_year <- left_join(
  ch4_by_veh_year,
  n2o_veh_year,
  by = join_by(year, `Vehicle Type`, `Fuel Type`)
)





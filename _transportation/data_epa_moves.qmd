## EPA MOVES {#sec-epa-moves}
```{r}
source(file.path(here::here(), "R/_load_pkgs.R"))
source(file.path(here::here(), "R/_quarto_helpers.R"))
epa_moves <- readRDS(file.path(here::here(), "_transportation/data/epa_moves.RDS"))
epa_moves_meta <- readRDS(file.path(here::here(), "_transportation/data/epa_moves_meta.RDS"))
hookaddcap()
```

Emissions rates for our region were calculated using the EPA's [Motor Vehicle Emissions Simulator (MOVES4)](https://www.epa.gov/moves) [@usepaMotorVehicleEmission2023]. MOVES4 calculates emissions factors using Council's regional travel demand model, Minnesota Department of Vehicle Services county vehicle registration data, and the Minnesota Pollution Control Agency vehicle age distribution. Each of these inputs helps the model estimate the characteristics of vehicles on the road in our region. The model takes into account differences in fuel economy (miles per gallon) depending on a vehicle's age and size, as well as its fuel intake (diesel or gasoline). The results are specific to the conditions of our region, and so are more accurate than national averages. 


CO~2~ equivalence values are derived from global warming potential (GWP) values. See @sec-gwp for more details.

```{r tbl-epa-moves-values}
#| tbl-cap: "Emissions in grams per vehicle mile traveled by vehicle weight in the Twin Cities region"
#| out-width: "95%"
epa_moves %>%
  rowwise() %>%
  mutate(
    `Kilograms CH4 per mile` = ch4 / 1000,
    `Kilograms N2O per mile` = n2o / 1000,
    `Kilograms CO2 per mile` = co2 / 1000,
    `Kilograms CO2e per mile` = co2_co2_equivalent / 1000
  ) %>%
  mutate(
    `Grams CH4 per mile` = `Kilograms CH4 per mile` * 1000,
    `Grams N2O per mile` = `Kilograms N2O per mile` * 1000,
    `Grams CO2 per mile` = `Kilograms CO2 per mile` * 1000,
    `Grams CO2e per mile` = `Kilograms CO2e per mile` * 1000
  ) %>%
  select(
    `Vehicle Weight` = vehicle_weight,
    `MOVES Year` = moves_year,
    starts_with("grams")
  ) %>%
  gt() %>%
  gt::opt_row_striping() %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  gt::as_raw_html()
```


```{r tbl-lggit-emissions-per-mile}
#| tbl-cap: "Grams of emissions per mile by vehicle type and fuel type"
#| out-width: "95%"

lggit_kg_emissions_per_mile <- readRDS(file.path(here::here(), "_transportation/data-raw/epa/lggit_kg_emissions_per_mile.RDS"))

lggit_kg_emissions_per_mile %>%
  select(
    `Vehicle Type`, `Vehicle Year`,
    `Fuel Type`,
    `Average miles per gallon`,
    `Kilograms CH4 per mile`,
    `Kilograms N2O per mile`,
    `Kilograms CO2 per mile`,
    `Kilograms CO2e per mile`
  ) %>%
  mutate(
    `Grams CH4 per mile` = `Kilograms CH4 per mile` * 1000,
    `Grams N2O per mile` = `Kilograms N2O per mile` * 1000,
    `Grams CO2 per mile` = `Kilograms CO2 per mile` * 1000,
    `Grams CO2e per mile` = `Kilograms CO2e per mile` * 1000
  ) %>%
  select(
    `Vehicle Type`, `Vehicle Year`,
    `Fuel Type`,
    starts_with("grams")
  ) %>%
  gt() %>%
  fmt_number(4:7, decimals = 3) %>%
  gt::opt_row_striping() %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  gt::as_raw_html()
```



Data source description, type

- Quality rank (See @tbl-quality-rank)
- How, when, and why was the data collected?
- If this is a modeled dataset, what is the sample?
- What is the raw unit of measurement? 
- How was this data accessed? Include any relevant links/citations, code, or downloads.
- What data cleaning or wrangling was completed? How did you test these processes and outputs?
- What is the geographic and temporal scope? Did you complete any aggregation?
- What version is the data? Were there other versions available? If so, why did you choose this version?
- What assumptions are made when we use this dataset?
- Which subject matter expert (SME) reviewed this data?
- Describe testing used to verify data

Be sure to add a citation of this dataset to the Zotero shared library.

### Data characteristics

- Were there any missing data? How did you handle missing data?
- Plots, tables, and description of data distribution
- Variance, Z-Score, quantiles
- Facet views by categorical variables

### Global Warming Potential

### Limitations

### Comparison with similar datasets

- [GHG Emission Factors Hub](https://www.epa.gov/climateleadership/ghg-emission-factors-hub)

### Data dictionary

```{r tbl-epa-moves-meta}
#| tbl-cap: "EPA MOVES metadata"
#| out-width: "95%"
epa_moves_meta %>%
  gt() %>%
  gt::opt_row_striping() %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  gt::fmt_markdown() %>%
  gt::as_raw_html()
```


Table with detailed description of columns and definitions for each data table.


```{r echo=FALSE}
saveCap("epa-moves")
```
